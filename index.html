<!DOCTYPE html>
<html>
<head>
<title>Proton editor</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="Description" content="Photon: free online resources for a variety of things." />
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Ubuntu&display=swap" rel="stylesheet">
<link rel='icon' href='https://upload.wikimedia.org/wikipedia/commons/f/f1/Ski_trail_rating_symbol_red_circle.png' type='image/png'/ > 
<link href="https://fonts.googleapis.com/css2?family=Material+Icons" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300&display=swap" rel="stylesheet">   
<style>
* {
font-family: 'Ubuntu', sans-serif;
border: none;
}
body {
background: #282828;
}
#editor {
position: absolute;
top: 0px;
left: 15%;
width: 84%;
height: 100%;
background: #282828;
color: #f3e3c2;
font-size: 16px;
z-index: 1;
}
.control {
width: 7.5%;
height: 50px;
background: transparent;
color: #999999;
border-radius: 2px;
}
.control:hover {
background: grey;
color: lightgrey;
}
#add-file {
position: absolute;
top: 0px;
left: 0px;
}
#download {
position: absolute;
top: 0px;
left: 7.5%;
}
#file {
position: absolute;
top: 60px;
left: 1%;
width: 13%;
height: 30px;
background: #282828;
border: 1px solid grey;
border-radius: 2px;
font-size: 16px;
color: grey;
text-align: center;
}
#file:hover {
opacity: 0.8;
}
#r {
position: fixed;
top: 200px;
left: 300px;
z-index: -1;
height: 20px;
border: none;
background: transparent;      
}
#fileInput {
position: absolute;
top: 110px;
left: 1%;
width: 13%;
background: transparent;
color: lightgrey;
}
</style>
<body onload="init()">
<!-- code editor section -->
<textarea id="editor" placeholder="Write code here..."></textarea>

<!-- controls section -->
<button class="control" id="add-file" title="Add file (Currently unavailable)"><span class="material-icons">note_add</span></button>
<button class="control" id="download" title="Download file" onclick="sendCode(); saveFot(r.value, file.value)"><span class="material-icons">save_alt</span></button>

<input type="text" id="file" placeholder="File title">

<input id="fileInput" type="file" name="file"/>
<pre id="fileContent"></pre>

<!-- file storage -->
<p id="r"></p>

<script>
//file download
function saveFot(textToWrite, fileNameToSaveAs)
    {
    	var textFileAsBlob = new Blob([textToWrite], {type: file.value}); 
    	var downloadLink = document.createElement("a");
    	downloadLink.download = fileNameToSaveAs;
    	downloadLink.innerHTML = "Download File";
    	if (window.webkitURL != null)
    	{
    		// Chrome allows the link to be clicked
    		// without actually adding it to the DOM.
    		downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
    	}
    	else
    	{
    		// Firefox requires the link to be added to the DOM
    		// before it can be clicked.
    		downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
    		downloadLink.onclick = destroyClickedElement;
    		downloadLink.style.display = "none";
    		document.body.appendChild(downloadLink);
    	}
    
    	downloadLink.click();
    } 



function sendCode() {
            var x =  
                document.getElementById("editor").value; 
            
            document.getElementById( 
              "r").value = x; 
        } 

//file uploading feature
function init(){
  document.getElementById('fileInput').addEventListener('change', handleFileSelect, false);
}

function handleFileSelect(event){
  const reader = new FileReader()
  reader.onload = handleFileLoad;
  reader.readAsText(event.target.files[0])
}

function handleFileLoad(event){
  console.log(event);
  document.getElementById('editor').textContent = event.target.result;
}
</script>
</body>
</html>
